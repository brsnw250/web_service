# Сервис обмена случайными картинками

## Обзор

Разработка сервиса, позволяющего обмениваться случайными картинками из выбранной категории.
Сервис позволяет получить картинку из категории и/или отправить картинку с меткой категории.

## Взаимодействие

Поскольку взаимодействие клиента и сервера может быть описано последовательностью
независимых событий то подразумевается асинхронная обработка запросов.

Основными примитивами взаимодействия являются функции, аргументы и результаты выполнения функция.

Так же не гарантируется значение результата при выполнении одного и того же запроса.

Поэтому выбрана модель взаимодействия `RPC`.

### Формат сообщений

 * `{"jsonrpc": "2.0", "method": "listCategories", "id": 3}` - получение списка доступных категорий
   
   `{"jsonrpc": "2.0", "result": [%categories%], "id": 3}` - ответ со списком категорий
   

 * `{"jsonrpc": "2.0", "method": "download", "id": 3}` - получение случайной картинки из всего набора
   
   `{"jsonrpc": "2.0", "result": [%category%, %base64_string%], "id": 3}` - ответ с тегом категории и картинкой в формате base64
   

 * `{"jsonrpc": "2.0", "method": "download", "params": {"category": %category%}, "id": 3}` - получение случайной картинки из выбранной категории
   
   `{"jsonrpc": "2.0", "result": %base64_string%, "id": 3}` - ответ с картинкой в формате base64
   

 * `{"jsonrpc": "2.0", "method": "upload", "params": {"category": %category%, "image": %base64_string%}, "id": 3}` - загрузка картинки в выбранную категорию
   
   `{"jsonrpc": "2.0", "result": %msg%, "id": 3}` - ответ содержит сообщение `success` в случае успеха и текст ошибки


`{"jsonrpc": "2.0", "error": {"code": %code%, "message": %msg%}, "id": 3}` - ответ в случае ошибки обработки запроса
 
 Картинки передаются в формате `base64`.

## CAP
Для описанного сервиса необходимо обеспечить доступность (Availability) и устойчивость к разделению
(Partition tolerance). Гарантирование доступности необходимо поскольку основной задачей сервиса является
обмен картинками между пользователями. Однако не гарантируется Сonsistency, т.к. чтение осуществляется случайно.
В качестве базы данных планируется использовать No-SQL поскольку сервис оперирует данными как независимыми 
случайными величинами. 

Для обеспечения AP можно использовать Apache Cassandra.
